<!doctype html>
<html lang="hu">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Forrásmegjelölés – online gyakorlók</title>

  <style>
    :root { font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif; line-height: 1.35; }
    body { margin: 0; background: #f6f7fb; color: #111; }
    .wrap { max-width: 820px; margin: 0 auto; padding: 24px; }
    .card { background: #fff; border-radius: 14px; padding: 18px; box-shadow: 0 6px 18px rgba(0,0,0,.06); }
    h1 { font-size: 22px; margin: 0 0 8px; }
    .muted { color: #555; font-size: 14px; margin: 0 0 14px; }
    .list { display: grid; gap: 12px; margin-top: 12px; }

    .item {
      border: 1px solid #e3e6f0;
      background: #fafbff;
      border-radius: 12px;
      padding: 14px;
      display: grid;
      gap: 8px;
    }
    .title { font-size: 16px; font-weight: 700; margin: 0; }
    .desc { font-size: 13px; color: #666; margin: 0; }
    .row { display: flex; gap: 10px; flex-wrap: wrap; align-items: center; }

    .pill {
      display:inline-block;
      padding: 4px 8px;
      border-radius: 999px;
      font-size: 12px;
      background: #eef3ff;
    }
    .ok { background: #e8fff0; color: #0a7a2f; border: 1px solid #bfeccc; }
    .bad { background: #fff0f0; color: #b00020; border: 1px solid #f3c2c8; }
    .wait { background: #fff7e8; color: #8a5200; border: 1px solid #f0d7a8; }

    a.btn, button.btn {
      border: 0;
      border-radius: 10px;
      padding: 10px 12px;
      font-size: 14px;
      cursor: pointer;
      text-decoration: none;
      display: inline-block;
      background: #1f6feb;
      color: #fff;
      font-weight: 700;
    }
    a.btn.secondary { background: #2f3542; }
    a.btn.ghost, button.btn.ghost { background: #e9ecf6; color: #111; font-weight: 600; }
    a.btn:disabled, button.btn:disabled { opacity: .6; cursor: not-allowed; }

    code {
      background: #f0f2fa;
      padding: 2px 6px;
      border-radius: 8px;
      font-size: 12px;
    }

    .hr { height: 1px; background: #eceef6; margin: 14px 0; }
    .small { font-size: 12px; color: #666; }
  </style>
</head>

<body>
  <div class="wrap">
    <div class="card">
      <h1>Forrásmegjelölés – gyakorló tesztek</h1>
      <p class="muted">
        Válaszd ki az évfolyamot. Az <b>index.html nem ment adatbázisba</b> – ezt a tesztoldalak (forras4/56/78) végzik a saját Firebase-ükben.
      </p>

      <div class="row">
        <button class="btn ghost" id="btnRecheck" type="button">Fájlok ellenőrzése</button>
        <span class="pill" id="baseInfo">Mappa: <code>docs/</code> (innen nyílnak a fájlok)</span>
      </div>

      <div class="hr"></div>

      <div class="list" id="list"></div>

      <div class="hr"></div>
      <div class="small">
        Ha valamelyik „Hiányzik / rossz név”:
        <ul>
          <li>ellenőrizd a fájl nevét (kis/nagybetű is számít),</li>
          <li>hogy tényleg a <code>docs</code> mappában van-e,</li>
          <li>és hogy a GitHub Pages beállítás <code>/docs</code>-ra mutat-e.</li>
        </ul>
      </div>
    </div>
  </div>

  <script>
    // 1) Itt add meg, milyen fájlokat akarsz indítani.
    //    A 56-oshoz több lehetséges fájlnév is szerepelhet, mert nálad össze-vissza volt elnevezve.
    const TESTS = [
      {
        key: "forras4",
        title: "4. osztály – alapfogalmak, forrás felismerése",
        desc: "Alap definíciók, mikor kell forrást írni, képek és idézetek.",
        candidates: ["forras4.html"]
      },
      {
        key: "forras56",
        title: "5–6. évfolyam – pontosabb hivatkozás, idézés",
        desc: "Pontosabb megjelölés, megbízhatóság, idézés/átfogalmazás.",
        // ✅ Ide tedd az(oka)t a fájlnevet, ami(k) tényleg léteznek a docs-ban:
        candidates: ["forras56.html", "forras5-6.html", "forras_56.html"]
      },
      {
        key: "forras78",
        title: "7–8. évfolyam – haladó forráskezelés",
        desc: "Nehezebb, gondolkodtató igen/nem indoklással. (Firebase beállítás még jön.)",
        candidates: ["forras78.html"]
      }
    ];

    const listEl = document.getElementById("list");
    const btnRecheck = document.getElementById("btnRecheck");

    function esc(s){ return String(s).replaceAll("&","&amp;").replaceAll("<","&lt;").replaceAll(">","&gt;"); }

    async function exists(path) {
      // HEAD gyorsabb, de GitHub Pages néha nem engedi: fallback GET-re.
      try {
        const r = await fetch(path, { method: "HEAD", cache: "no-store" });
        if (r.ok) return true;
        // fallback GET
        const r2 = await fetch(path, { method: "GET", cache: "no-store" });
        return r2.ok;
      } catch {
        return false;
      }
    }

    async function pickFirstExisting(candidates) {
      for (const file of candidates) {
        const ok = await exists("./" + file);
        if (ok) return file;
      }
      return null;
    }

    async function render() {
      listEl.innerHTML = "";

      for (const t of TESTS) {
        const file = await pickFirstExisting(t.candidates);

        const box = document.createElement("div");
        box.className = "item";

        const title = document.createElement("div");
        title.className = "title";
        title.textContent = t.title;

        const desc = document.createElement("div");
        desc.className = "desc";
        desc.textContent = t.desc;

        const row = document.createElement("div");
        row.className = "row";

        const status = document.createElement("span");
        status.className = "pill";

        const openBtn = document.createElement("a");
        openBtn.className = "btn";
        openBtn.textContent = "Indítás";
        openBtn.target = "_self";
        openBtn.rel = "noopener";

        const hintBtn = document.createElement("a");
        hintBtn.className = "btn ghost";
        hintBtn.textContent = "Fájlnév mutatása";
        hintBtn.href = "#";
        hintBtn.onclick = (e) => {
          e.preventDefault();
          alert(
            "Próbált fájlnevek ennél a tesztnél:\n\n" +
            t.candidates.map(x => "• " + x).join("\n") +
            (file ? ("\n\nTalált és megnyitott fájl: " + file) : "\n\nNem találtam egyik fájlt sem.")
          );
          return false;
        };

        if (file) {
          status.textContent = "OK – fájl megtalálva";
          status.classList.add("ok");
          openBtn.href = "./" + file;
        } else {
          status.textContent = "Hiányzik / rossz név (404)";
          status.classList.add("bad");
          openBtn.href = "#";
          openBtn.classList.add("secondary");
          openBtn.onclick = (e) => {
            e.preventDefault();
            alert("Nem találom a fájlt a docs mappában. Nézd meg a 'Fájlnév mutatása' gombot.");
            return false;
          };
        }

        row.appendChild(status);
        row.appendChild(openBtn);
        row.appendChild(hintBtn);

        // plusz kis sor: melyik fájlt nyitja
        const fileLine = document.createElement("div");
        fileLine.className = "small";
        fileLine.innerHTML = file
          ? `Megnyitott fájl: <code>${esc(file)}</code>`
          : `Keresett fájlnevek: <code>${esc(t.candidates.join(" / "))}</code>`;

        box.appendChild(title);
        box.appendChild(desc);
        box.appendChild(row);
        box.appendChild(fileLine);

        listEl.appendChild(box);
      }
    }

    btnRecheck.addEventListener("click", render);
    render();
  </script>
</body>
</html>
